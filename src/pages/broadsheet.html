<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Broadsheet - Lifer School</title>
    <link rel="stylesheet" href="../assets/index.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
      integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <style>
      /* Inherited Styles from JSS/SSS Templates */
      @font-face {
        font-family: "ITC";
        src: url(../assets/fonts/ITC-Machine-Medium.otf);
      }

      .header-title {
        width: 100%;
        display: flex;
        justify-content: center; /* Centering as requested */
        align-items: center;
      }

      /* Logo defaults */
      .logo {
        width: 110px;
        height: 110px;
        background-position: center;
        background-size: contain;
        background-repeat: no-repeat;
        flex-shrink: 0;
      }

      .left {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2px;
        font-weight: 900;
        text-align: center;
        font-family: Arial, Helvetica, sans-serif;
      }

      .school-name {
        font-size: 60px; /* Slightly smaller than 75 to fit print width */
        color: #006b2d;
        line-height: 1.1;
        font-family: "ITC", sans-serif;
        text-align: center;
        background: linear-gradient(
          180deg,
          #7ab85c 0%,
          #4a7c3a 50%,
          #2d5a28 100%
        );
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 2px 3px 5px rgba(0, 0, 0, 0.4);
        filter: drop-shadow(0 1px 0 rgba(255, 255, 255, 0.3));
        -webkit-text-stroke: 1.2px white;
        letter-spacing: 0px;
        font-weight: 900;
        white-space: nowrap;
      }

      .address {
        background-color: #006336;
        color: white;
        padding: 4px 10px;
        border-radius: 8px;
        font-size: 12px;
        margin-top: 5px;
      }

      .add-highlight,
      .phone-highlight {
        color: yellow;
      }
      .phone-highlight {
        color: #b70d18;
      }

      .motto {
        font-size: 16px;
        margin: 2px 0;
      }

      .contact {
        display: flex;
        gap: 15px;
        align-items: center;
        font-size: 12px;
      }

      .result-class {
        font-size: 18px;
        padding: 2px 10px;
        background-color: #b70d18;
        color: white;
        border-radius: 8px;
        text-transform: uppercase;
        margin-top: 5px;
        font-weight: bold;
      }

      /* Broadsheet Specific Overrides */
      .broadsheet-page {
        padding: 20px;
        overflow-y: auto;
      }

      .sheet-container {
        background: white;
        padding: 20px;
        min-height: 600px;
        overflow-x: auto;
      }

      /* ===== BROADSHEET TABLE - CLEAN & SIMPLE ===== */
      .bs-table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
        font-size: 8px;
        margin-top: 5px;
      }

      .bs-table th,
      .bs-table td {
        border: 1px solid #000;
        padding: 2px;
        text-align: center;
        box-sizing: border-box;
      }

      /* S/N Column */
      .col-sn {
        width: 20px !important;
      }

      /* Name Column - Fixed narrow width */
      .col-name {
        width: 100px !important;
        text-align: left !important;
        padding-left: 2px !important;
        font-weight: bold;
        font-size: 7px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      /* Score columns - all uniform */
      .bs-table th.vertical-header,
      .bs-table td:not(.col-sn):not(.col-name) {
        width: 22px !important;
      }

      /* Vertical headers */
      .bs-table th.vertical-header {
        height: 180px;
        vertical-align: bottom;
        padding: 0 0 8px 0;
        position: relative;
        text-transform: uppercase;
      }

      .bs-table th.vertical-header > div {
        transform: rotate(-90deg);
        transform-origin: center bottom;
        position: absolute;
        bottom: 15px;
        left: 50%;
        margin-left: -5px;
        white-space: nowrap;
        font-size: 8px;
        width: 20px;
      }

      /* Container and watermark */
      .broadsheet-print-container {
        position: relative;
        width: 1120px; /* Fixed width for perfect PDF match */
        max-width: 100%;
        background: white;
        padding: 5px;
        margin: 0 auto; /* Center it */
      }

      .broadsheet-watermark {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50%;
        height: 50%;
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
        opacity: 0.05;
        pointer-events: none;
        z-index: 0;
      }

      @media print {
        @page {
          size: landscape;
          margin: 5mm;
        }

        body {
          margin: 0;
          padding: 0;
        }

        aside,
        .controls-section,
        .dashboard-action {
          display: none !important;
        }

        .dashboard-page {
          width: 100% !important;
          padding: 0 !important;
          margin: 0 !important;
        }

        .sheet-container {
          box-shadow: none !important;
          padding: 0 !important;
          margin: 0 !important;
          width: 100% !important;
          overflow: visible !important;
        }

        .broadsheet-print-container {
          width: 100% !important;
          max-width: none !important;
        }

        * {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar (Hardcoded for now as per other pages) -->
    <aside>
      <div class="sidebar-wrapper">
        <div class="sidebar-header">
          <h3>Lifer's Results</h3>
          <p class="gray-medium">Management Platform</p>
        </div>
        <div class="sd-parent">
          <nav class="links-wrapper">
            <ul>
              <li>
                <a href="../pages/index.html"
                  ><span class="material-symbols-outlined">dashboard</span
                  ><span>Dashboard</span></a
                >
              </li>
              <li>
                <a href="../pages/editor.html"
                  ><span class="material-symbols-outlined">description</span
                  ><span>Legacy Editor</span></a
                >
              </li>
              <li>
                <a href="../pages/student.html"
                  ><span class="material-symbols-outlined">group</span
                  ><span>Students</span></a
                >
              </li>
              <li>
                <a href="../pages/result-manager.html"
                  ><span class="material-symbols-outlined">assignment</span
                  ><span>Student Results</span></a
                >
              </li>
              <li>
                <a href="../pages/broadsheet.html" class="active"
                  ><span class="material-symbols-outlined">table_view</span
                  ><span>Broadsheet</span></a
                >
              </li>
              <li>
                <a href="../pages/attendance.html"
                  ><span class="material-symbols-outlined">calendar_month</span
                  ><span>Attendance</span></a
                >
              </li>
              <li>
                <a href="../pages/subject.html"
                  ><span class="material-symbols-outlined">school</span
                  ><span>Classes & Subjects</span></a
                >
              </li>
              <li>
                <a href="../pages/settings.html"
                  ><span class="material-symbols-outlined">settings</span
                  ><span>Settings</span></a
                >
              </li>
            </ul>
          </nav>
          <div class="sidebar-footer">
            <span class="user-name">Admin User</span>
            <span class="user-type">Super_admin</span>
            <a href="#"
              ><span class="material-symbols-outlined">logout</span
              ><span>Logout</span></a
            >
          </div>
        </div>
      </div>
    </aside>

    <main>
      <section class="dashboard-page">
        <div class="dashboard-action">
          <div class="dash-greetings">
            <h2>Broadsheet</h2>
            <p>Master result summary for entire class</p>
          </div>
        </div>

        <div class="controls-section">
          <div class="form-group">
            <label>Academic Year</label>
            <select id="academicYear" class="form-control"></select>
          </div>
          <div class="form-group">
            <label>Class</label>
            <select id="classLevel" class="form-control">
              <option value="">Select Class</option>
            </select>
          </div>
          <div class="form-group">
            <label>Term</label>
            <select id="termSelect" class="form-control">
              <option value="firstTerm">First Term</option>
              <option value="secondTerm">Second Term</option>
              <option value="thirdTerm">Third Term</option>
            </select>
          </div>
          <button id="loadBroadsheet" class="btn btn-primary">
            <span class="material-symbols-outlined">table_view</span>
            Load Broadsheet
          </button>
          <button
            id="downloadAllBtn"
            class="btn btn-primary"
            style="background: #006b2d; margin-left: auto; margin-right: 10px"
          >
            <span class="material-symbols-outlined">folder_zip</span>
            Download All Results
          </button>
          <button
            id="printBtn"
            class="btn btn-primary"
            style="background: #555"
          >
            <span class="material-symbols-outlined">print</span>
            Print
          </button>
        </div>

        <div class="sheet-container" id="sheetContainer">
          <div style="text-align: center; padding: 60px; color: #999">
            <span
              class="material-symbols-outlined"
              style="font-size: 64px; opacity: 0.3"
              >dataset</span
            >
            <p>Select class and term to view broadsheet.</p>
          </div>
        </div>
      </section>
    </main>

    <script type="module" src="../scripts/auth-guard.js"></script>
    <script type="module" src="../scripts/broadsheet.js"></script>
    <script type="module" src="../scripts/sidebar-toggle.js"></script>
  </body>
</html>

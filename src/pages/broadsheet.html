<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Broadsheet - Lifer School</title>
    <link rel="stylesheet" href="../assets/index.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
      integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <style>
      .broadsheet-page {
        padding: 20px;
        overflow-y: auto;
      }

      .controls-section {
        background: white;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e0e0e0;
        display: flex;
        gap: 15px;
        align-items: flex-end;
        flex-wrap: wrap;
        margin-bottom: 20px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .form-group label {
        font-weight: 600;
        font-size: 13px;
        color: #555;
      }

      .form-control {
        padding: 9px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        min-width: 160px;
        font-family: inherit;
        font-size: 14px;
      }

      .btn {
        padding: 10px 18px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.2s;
        font-family: inherit;
      }

      .btn-primary {
        background: #000;
        color: white;
      }

      .btn:hover {
        opacity: 0.9;
        transform: translateY(-1px);
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* Broadsheet Table Styles */
      .sheet-container {
        background: white;
        padding: 40px; /* Padding for print margins */
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        overflow-x: auto;
        min-height: 600px;
      }

      .sheet-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
        border-bottom: 2px solid #000;
        padding-bottom: 10px;
      }

      .school-info {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .logo-box {
        width: 100px;
        height: 100px;
        background-image: url("/assets/logo.png"); /* Ensure this path is correct or use class */
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
      }

      .school-text h1 {
        font-size: 28px;
        font-weight: 900;
        margin: 0;
        text-transform: uppercase;
        color: #2d5a28; /* Greenish tone */
      }

      .school-text p {
        margin: 5px 0 0;
        font-size: 14px;
      }

      .sheet-meta {
        text-align: right;
        font-weight: bold;
      }

      .bs-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
      }

      .bs-table th,
      .bs-table td {
        border: 1px solid #000;
        padding: 4px 8px;
        text-align: center;
      }

      .bs-table th.vertical-header {
        height: 140px;
        white-space: nowrap;
        vertical-align: bottom;
        padding-bottom: 10px;
      }

      .bs-table th.vertical-header > div {
        writing-mode: vertical-rl;
        transform: rotate(180deg);
        width: 20px;
        margin: 0 auto;
        text-align: left; /* Becomes top after rotation */
      }

      .col-sn {
        width: 40px;
      }
      .col-name {
        width: 250px;
        text-align: left !important;
        font-weight: bold;
      }

      .score-cell {
        font-family: "Courier New", monospace;
      }

      @media print {
        aside,
        .controls-section,
        .navigation {
          display: none !important;
        }
        .dashboard-page {
          padding: 0;
        }
        .sheet-container {
          box-shadow: none;
          padding: 0;
        }
        @page {
          size: landscape;
          margin: 10mm;
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar (Hardcoded for now as per other pages) -->
    <aside>
      <div class="sidebar-wrapper">
        <div class="sidebar-header">
          <h3>Lifer's Results</h3>
          <p class="gray-medium">Management Platform</p>
        </div>
        <div class="sd-parent">
          <nav class="links-wrapper">
            <ul>
              <li>
                <a href="../pages/index.html"
                  ><span class="material-symbols-outlined">dashboard</span
                  ><span>Dashboard</span></a
                >
              </li>
              <li>
                <a href="../pages/editor.html"
                  ><span class="material-symbols-outlined">description</span
                  ><span>Legacy Editor</span></a
                >
              </li>
              <li>
                <a href="../pages/student.html"
                  ><span class="material-symbols-outlined">group</span
                  ><span>Students</span></a
                >
              </li>
              <li>
                <a href="../pages/result-manager.html"
                  ><span class="material-symbols-outlined">assignment</span
                  ><span>Student Results</span></a
                >
              </li>
              <li>
                <a href="../pages/broadsheet.html" class="active"
                  ><span class="material-symbols-outlined">table_view</span
                  ><span>Broadsheet</span></a
                >
              </li>
              <li>
                <a href="../pages/attendance.html"
                  ><span class="material-symbols-outlined">calendar_month</span
                  ><span>Attendance</span></a
                >
              </li>
              <li>
                <a href="../pages/subject.html"
                  ><span class="material-symbols-outlined">school</span
                  ><span>Classes & Subjects</span></a
                >
              </li>
              <li>
                <a href="../pages/settings.html"
                  ><span class="material-symbols-outlined">settings</span
                  ><span>Settings</span></a
                >
              </li>
            </ul>
          </nav>
          <div class="sidebar-footer">
            <span class="user-name">Admin User</span>
            <span class="user-type">Super_admin</span>
            <a href="#"
              ><span class="material-symbols-outlined">logout</span
              ><span>Logout</span></a
            >
          </div>
        </div>
      </div>
    </aside>

    <main>
      <section class="dashboard-page">
        <div class="dashboard-action">
          <div class="dash-greetings">
            <h2>Broadsheet</h2>
            <p>Master result summary for entire class</p>
          </div>
        </div>

        <div class="controls-section">
          <div class="form-group">
            <label>Academic Year</label>
            <select id="academicYear" class="form-control"></select>
          </div>
          <div class="form-group">
            <label>Class</label>
            <select id="classLevel" class="form-control">
              <option value="">Select Class</option>
            </select>
          </div>
          <div class="form-group">
            <label>Term</label>
            <select id="termSelect" class="form-control">
              <option value="firstTerm">First Term</option>
              <option value="secondTerm">Second Term</option>
              <option value="thirdTerm">Third Term</option>
            </select>
          </div>
          <button id="loadBroadsheet" class="btn btn-primary">
            <span class="material-symbols-outlined">table_view</span>
            Load Broadsheet
          </button>
          <button
            id="printBtn"
            class="btn btn-primary"
            style="background: #555; margin-left: auto"
          >
            <span class="material-symbols-outlined">print</span>
            Print
          </button>
        </div>

        <div class="sheet-container" id="sheetContainer">
          <div style="text-align: center; padding: 60px; color: #999">
            <span
              class="material-symbols-outlined"
              style="font-size: 64px; opacity: 0.3"
              >dataset</span
            >
            <p>Select class and term to view broadsheet.</p>
          </div>
        </div>
      </section>
    </main>

    <script type="module" src="../scripts/auth-guard.js"></script>
    <script type="module" src="../scripts/broadsheet.js"></script>
    <script type="module" src="../scripts/sidebar-toggle.js"></script>
  </body>
</html>
